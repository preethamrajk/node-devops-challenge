trigger: none

pool:
  vmImage: 'ubuntu-latest'

stages:
  - stage: Build 
    jobs:
      - job: 'Build'
        steps:
          - task: NodeTool@0
            inputs:
              versionSpec: '12.15.0'
            displayName: 'Install Node.js'         

          - script: |
              yarn install
            displayName: 'Install packages'          

          - script: |
              yarn build
            displayName: 'Build package'          
            
          - script: |
              yarn test
            displayName: 'Run Unit Tests'          

          - task: PublishTestResults@2
            displayName: 'Publish results' 
            inputs:
              testResultsFormat: 'JUnit'
              testResultsFiles: |
                **/junit.xml                
              searchFolder: '$(Build.Repository.LocalPath)'
              testRunTitle: 'Unit test results'
            condition: succeededOrFailed()